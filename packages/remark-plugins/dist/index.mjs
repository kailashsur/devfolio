import C from"remark-frontmatter";import E from"remark-gfm";import{z as o}from"zod";import{Parser as x}from"acorn";import y from"acorn-jsx";import b from"front-matter";import M from"slug";var w=x.extend(y()),d=t=>w.parse(t,{ecmaVersion:2020,sourceType:"module"}),l=t=>b(t).attributes,m=(t,r,e)=>{t.children.unshift({type:"mdxjsEsm",data:{estree:d(`import ${r} from '${e}'`)}})},p=(t,r)=>{t.children.push({type:"mdxjsEsm",data:{estree:d(r)}})},f=t=>{let r=[];for(let e=0;e<t.children.length;e++){let n=t.children[e];if(n.type==="heading"&&[2,3].includes(n.depth)){let a=n.depth-1,s=n.children.filter(i=>i.type==="text").map(i=>i.value).join("");r.push({title:s,slug:M(s),depth:a})}}return r};var j=/^\d{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$/,k=o.object({title:o.string().max(110),description:o.string().max(120),caption:o.string().default(""),layout:o.string().default("Post")}),F=o.object({date:o.string().regex(j,"Date format MUST be YYYY-MM-DD"),lang:o.enum(["id","en"]),tags:o.array(o.string()).min(2).max(5),category:o.string()}),O=o.object({githubUrl:o.string().url().optional(),npmUrl:o.string().url().optional(),type:o.enum(["package"]).default("package")}),c=(t,r)=>{try{return t.parse(r)}catch(e){if(e instanceof o.ZodError)throw new Error(JSON.stringify(e.issues,null,2));return null}},P=()=>(t,r)=>{let e=l(r.value);if(Object.keys(e).length===0)return;let n=c(k,e),a;switch(n.layout){case"Post":{let s=c(F,e);a={...n,...s};break}case"Project":{let s=c(O,e);a={...n,...s};break}default:{a=n;break}}r.data["front-matter"]=a},u=P;var $=()=>(t,r)=>{let e=r.data["front-matter"]||{};if(Object.keys(e).length===0)return;let{layout:n,...a}=r.data["front-matter"],s=f(t);m(t,n,`@/contents-layouts/${n}`),p(t,`export default ({ children }) => (
      <${n}
        frontMatter={${JSON.stringify(a)}}
        tableOfContents={${JSON.stringify(s)}}
      >
        {children}
      </${n}>
     )`)},h=$;var S=()=>t=>{for(let r=0;r<t.children.length;r++){let e=t.children[r];if(e.type==="heading"&&![2,3].includes(e.depth)||e.type==="mdxJsxFlowElement"&&["h1","h4","h5","h6"].includes(e.name))throw new Error("Headings depths other than 2 or 3 are not allowed.")}},g=S;var J=[C,E,u,g,h],Z=J;export{Z as default};
